@AbapCatalog.sqlViewName: 'ZDLREVENUE1'
@AbapCatalog.compiler.compareFilter: true
@AbapCatalog.preserveKey: true
@AccessControl.authorizationCheck: #NOT_REQUIRED
@EndUserText.label: 'GROUP BY'
define view ZDL_CUSTOMER_WITH_REVENUE as select from ZDL_BOOKING_AND_CUSTOMER as c
{
    key c.customid as id,
    c.name,
    c.street,
    c.postcode,
    c.city,
    c.country,
    
    @Semantics.amount.currencyCode: 'true'
    c.currency,
    avg(c.days_ahead) as days_ahead
}
group by 
 c.customid,
 c.name,
 c.postcode,
 c.street,
 c.city,
 c.country,
 c.currency
